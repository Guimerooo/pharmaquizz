<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PharmaQuizz</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <script type="text/babel">
    const { useState, useEffect } = React;

    // IC√îNES SVG
    const BookOpen = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
      </svg>
    );
    const Brain = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/>
        <path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/>
      </svg>
    );
    const ChevronLeft = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="15 18 9 12 15 6"/>
      </svg>
    );
    const ChevronRight = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="9 18 15 12 9 6"/>
      </svg>
    );
    const Settings = ({ size = 24, style }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" style={style}>
        <circle cx="12" cy="12" r="3"/><path d="M12 1v6m0 6v6"/>
      </svg>
    );
    const Plus = ({ size = 24, style }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" style={style}>
        <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
      </svg>
    );
    const Trash2 = ({ size = 24, color }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color || "currentColor"} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
      </svg>
    );
    const Edit = ({ size = 24, color }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color || "currentColor"} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
      </svg>
    );
    const Camera = ({ size = 24, color }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color || "currentColor"} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/>
      </svg>
    );
    const Check = ({ size = 24, style }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" style={style}>
        <polyline points="20 6 9 17 4 12"/>
      </svg>
    );
    const X = ({ size = 24, style }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" style={style}>
        <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    );

    
// ========================================
    // LISTE DES M√âDICAMENTS DE D√âPART
    // ========================================
    // Cette liste sera charg√©e automatiquement pour tous les utilisateurs
    // Pour ajouter vos 272 m√©dicaments, remplacez simplement ce tableau
    // Format : { dci: "...", commercial: ["..."], category: "...", image: null }
    
    const INITIAL_MEDS = [
  {"dci": "Tacrolimus", "commercial": ["Advagraf"], "category": "Immunosuppresseur", "image": null},
  {"dci": "Desloratadine", "commercial": ["Aerius"], "category": "Antiallergique", "image": null},
  {"dci": "Parac\u00e9tamol + acide ac\u00e9tylsalicylique + caf\u00e9ine", "commercial": ["Afebryl"], "category": "Autre", "image": null},
  {"dci": "Spironolactone", "commercial": ["Aldactone"], "category": "Antihypertenseur", "image": null},
  {"dci": "Parac\u00e9tamol + caf\u00e9ine", "commercial": ["Algostase"], "category": "Autre", "image": null},
  {"dci": "Parac\u00e9tamol + cod\u00e9ine", "commercial": ["Algotra"], "category": "Antalgique", "image": null},
  {"dci": "Amlodipine", "commercial": ["Amlor"], "category": "Antihypertenseur", "image": null},
  {"dci": "Amoxicilline + acide clavulanique", "commercial": ["Amoxiclav"], "category": "Antibiotique", "image": null},
  {"dci": "Extrait de gingembre", "commercial": ["Antimetil"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Insuline glulisine", "commercial": ["Apidra"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Fl\u00e9ca\u00efnide", "commercial": ["Apocard"], "category": "Antiarythmique", "image": null},
  {"dci": "Acide salicylique", "commercial": ["Aporil"], "category": "Autre", "image": null},
  {"dci": "\u00c9toriocoxib", "commercial": ["Arcoxia"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "Acide ac\u00e9tylsalicylique", "commercial": ["Asa"], "category": "Antalgique", "image": null},
  {"dci": "Acide ac\u00e9tylsalicylique", "commercial": ["Asaflow"], "category": "Autre", "image": null},
  {"dci": "Hydroxyzine", "commercial": ["Atarax"], "category": "Anxiolytique", "image": null},
  {"dci": "\u00c9z\u00e9timibe + atorvastatine", "commercial": ["Atozet"], "category": "Hypolip\u00e9miant", "image": null},
  {"dci": "Ipratropium", "commercial": ["Atrovent"], "category": "Bronchodilatateur", "image": null},
  {"dci": "Amoxicilline + acide clavulanique", "commercial": ["Augmentin"], "category": "Antibiotique", "image": null},
  {"dci": "Furoate de fluticasone", "commercial": ["Avamys"], "category": "Cortico\u00efde", "image": null},
  {"dci": "Moxifloxacine", "commercial": ["Avelox"], "category": "Antibiotique", "image": null},
  {"dci": "Brinzolamide", "commercial": ["Azopt"], "category": "Ophtalmologie", "image": null},
  {"dci": "Probiotiques (Lactobacillus spp.)", "commercial": ["Bactecal"], "category": "Probiotique", "image": null},
  {"dci": "Lactobacillus rhamnosus GG", "commercial": ["Bactiol"], "category": "Probiotique", "image": null},
  {"dci": "Sulfam\u00e9thoxazole + trim\u00e9thoprime", "commercial": ["Bactrim"], "category": "Antibiotique", "image": null},
  {"dci": "Complexe de vitamines B", "commercial": ["Befact"], "category": "Autre", "image": null},
  {"dci": "Bilastine", "commercial": ["Bellozal"], "category": "Antiallergique", "image": null},
  {"dci": "Olm\u00e9sartan", "commercial": ["Belsar"], "category": "Antihypertenseur", "image": null},
  {"dci": "Thiamine (vitamine B1)", "commercial": ["Benerva"], "category": "Autre", "image": null},
  {"dci": "B\u00e9tahistine", "commercial": ["Betaserc"], "category": "Autre", "image": null},
  {"dci": "Lactulose", "commercial": ["Bifiteral"], "category": "Laxatif", "image": null},
  {"dci": "Bromhexine", "commercial": ["Bisolvon"], "category": "Respiratoire", "image": null},
  {"dci": "Vaccin dipht\u00e9rie-t\u00e9tanos-coqueluche", "commercial": ["Boostrix"], "category": "Vaccin", "image": null},
  {"dci": "Dextrom\u00e9thorphane ou guaif\u00e9n\u00e9sine (selon version)", "commercial": ["Bronchosedal"], "category": "Autre", "image": null},
  {"dci": "Ibuprof\u00e8ne", "commercial": ["Brufen"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "Bum\u00e9tanide", "commercial": ["Burinex"], "category": "Diur\u00e9tique", "image": null},
  {"dci": "Hyoscine butylbromide", "commercial": ["Buscopan"], "category": "Autre", "image": null},
  {"dci": "Diclof\u00e9nac", "commercial": ["Cataflam"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "Mycoph\u00e9nolate mof\u00e9til", "commercial": ["Cellcept"], "category": "Immunosuppresseur", "image": null},
  {"dci": "Dim\u00e9thylbenz\u00e8ne + terp\u00e8ne", "commercial": ["Cerulyx"], "category": "Autre", "image": null},
  {"dci": "Ciprofloxacine", "commercial": ["Ciloxan"], "category": "Antibiotique", "image": null},
  {"dci": "Ciprofloxacine", "commercial": ["Ciproxine"], "category": "Antibiotique", "image": null},
  {"dci": "M\u00e9latonine", "commercial": ["Circadin"], "category": "Autre", "image": null},
  {"dci": "\u00c9noxaparine", "commercial": ["Clexane"], "category": "Anticoagulant", "image": null},
  {"dci": "Zuclopenthixol", "commercial": ["Clopixol"], "category": "Antipsychotique", "image": null},
  {"dci": "Cloraz\u00e9pate dipotassique", "commercial": ["Clozan"], "category": "Anxiolytique", "image": null},
  {"dci": "Chlorhexidine + lidoca\u00efne", "commercial": ["Colludol"], "category": "Antiseptique", "image": null},
  {"dci": "Ipratropium + salbutamol", "commercial": ["Combivent"], "category": "Bronchodilatateur", "image": null},
  {"dci": "Parac\u00e9tamol + cod\u00e9ine + caf\u00e9ine", "commercial": ["Combophen"], "category": "Antalgique", "image": null},
  {"dci": "Tramadol", "commercial": ["Contramal"], "category": "Antalgique opio\u00efde", "image": null},
  {"dci": "Amiodarone", "commercial": ["Cordarone"], "category": "Antiarythmique", "image": null},
  {"dci": "Agents nettoyants", "commercial": ["Corega"], "category": "Autre", "image": null},
  {"dci": "Digluconate de chlorhexidine", "commercial": ["Corsodyl"], "category": "Antiseptique", "image": null},
  {"dci": "Molsidomine- anti-angineux", "commercial": ["Coruno"], "category": "Autre", "image": null},
  {"dci": "Dorzolamide + timolol", "commercial": ["Cosopt"], "category": "Ophtalmologie", "image": null},
  {"dci": "P\u00e9rindopril + amlodipine", "commercial": ["Coveram"], "category": "Antihypertenseur", "image": null},
  {"dci": "P\u00e9rindopril", "commercial": ["Coversyl"], "category": "Antihypertenseur", "image": null},
  {"dci": "Losartan", "commercial": ["Cozaar"], "category": "Antihypertenseur", "image": null},
  {"dci": "Enzymes pancr\u00e9atiques (pancr\u00e9atine)", "commercial": ["Creon"], "category": "Autre", "image": null},
  {"dci": "Rosuvastatine", "commercial": ["Crestor"], "category": "Hypolip\u00e9miant", "image": null},
  {"dci": "Nutriments / arginine / zinc", "commercial": ["Cubitan"], "category": "Dermatologie", "image": null},
  {"dci": "Dulox\u00e9tine", "commercial": ["Cymbalta"], "category": "Antid\u00e9presseur", "image": null},
  {"dci": "Parac\u00e9tamol", "commercial": ["Dafalgan"], "category": "Antalgique", "image": null},
  {"dci": "Diosmine + hesp\u00e9ridine", "commercial": ["Daflon"], "category": "Autre", "image": null},
  {"dci": "Clindamycine", "commercial": ["Dalacin"], "category": "Antibiotique", "image": null},
  {"dci": "Lactulose", "commercial": ["Daliport"], "category": "Laxatif", "image": null},
  {"dci": "Flupentixol + m\u00e9litrac\u00e8ne", "commercial": ["Deanxit"], "category": "Anxiolytique", "image": null},
  {"dci": "Valproate de sodium", "commercial": ["Depakine"], "category": "Anti\u00e9pileptique", "image": null},
  {"dci": "Ac\u00e9tazolamide", "commercial": ["Diamox"], "category": "Diur\u00e9tique", "image": null},
  {"dci": "B\u00e9tam\u00e9thasone", "commercial": ["Diprosone"], "category": "Cortico\u00efde", "image": null},
  {"dci": "Alim\u00e9mazine", "commercial": ["Dominal"], "category": "Anxiolytique", "image": null},
  {"dci": "Loprazolam", "commercial": ["Dormonoct"], "category": "Anxiolytique", "image": null},
  {"dci": "Bisacodyl", "commercial": ["Dulcolax"], "category": "Laxatif", "image": null},
  {"dci": "Ipratropium + f\u00e9not\u00e9rol", "commercial": ["Duovent"], "category": "Bronchodilatateur", "image": null},
  {"dci": "Lactulose", "commercial": ["Duphalac"], "category": "Laxatif", "image": null},
  {"dci": "Fentanyl", "commercial": ["Durogesic"], "category": "Antalgique opio\u00efde", "image": null},
  {"dci": "Venlafaxine", "commercial": ["Efexor"], "category": "Antid\u00e9presseur", "image": null},
  {"dci": "\u00c9til\u00e9frine", "commercial": ["Effortil"], "category": "Autre", "image": null},
  {"dci": "Vaccin grippe quadrivalent", "commercial": ["Efluelda"], "category": "Vaccin", "image": null},
  {"dci": "Apixaban", "commercial": ["Eliquis"], "category": "Anticoagulant", "image": null},
  {"dci": "Mom\u00e9tasone", "commercial": ["Elocom"], "category": "Cortico\u00efde", "image": null},
  {"dci": "Chlorhexidine + chlorobutanol", "commercial": ["Eludril"], "category": "Antiseptique", "image": null},
  {"dci": "M\u00e9toclopramide", "commercial": ["Emistyl"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Lidoca\u00efne + priloca\u00efne", "commercial": ["Emla"], "category": "Autre", "image": null},
  {"dci": "Saccharomyces boulardii", "commercial": ["Enterol"], "category": "Probiotique", "image": null},
  {"dci": "Sacubitril + valsartan", "commercial": ["Entresto"], "category": "Autre", "image": null},
  {"dci": "M\u00e9thylph\u00e9nidate", "commercial": ["Equasym"], "category": "Autre", "image": null},
  {"dci": "L\u00e9vothyroxine", "commercial": ["Euthyrox"], "category": "Autre", "image": null},
  {"dci": "Acide tranexamique", "commercial": ["Exacyl"], "category": "Autre", "image": null},
  {"dci": "Parac\u00e9tamol + caf\u00e9ine + aspirine", "commercial": ["Exedryn"], "category": "Autre", "image": null},
  {"dci": "K\u00e9toprof\u00e8ne", "commercial": ["Fastum"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "L\u00e9trozole", "commercial": ["Femara"], "category": "Autre", "image": null},
  {"dci": "Dim\u00e9tind\u00e8ne", "commercial": ["Fenistil"], "category": "Antiallergique", "image": null},
  {"dci": "Fer + vitamines B12 + acide folique", "commercial": ["Ferrodyn"], "category": "Autre", "image": null},
  {"dci": "Hydrogel (carbom\u00e8re)", "commercial": ["Flamigel"], "category": "Dermatologie", "image": null},
  {"dci": "Enzymes + alginate", "commercial": ["Flaminal"], "category": "Dermatologie", "image": null},
  {"dci": "Chlorhexidine + chlorobutanol", "commercial": ["Flamirins"], "category": "Antiseptique", "image": null},
  {"dci": "Sulfadiazine argentique", "commercial": ["Flammazine"], "category": "Antiseptique", "image": null},
  {"dci": "Diclof\u00e9nac", "commercial": ["Flexicream"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "M\u00e9loxicam", "commercial": ["Flexium"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "Indapamide", "commercial": ["Fludex"], "category": "Antihypertenseur", "image": null},
  {"dci": "Ac\u00e9tylcyst\u00e9ine", "commercial": ["Fluimucil"], "category": "Respiratoire", "image": null},
  {"dci": "Acide folique", "commercial": ["Folavit"], "category": "Autre", "image": null},
  {"dci": "Macrogol 4000", "commercial": ["Forlax"], "category": "Laxatif", "image": null},
  {"dci": "B\u00e9naz\u00e9pril", "commercial": ["Fortekor"], "category": "Antihypertenseur", "image": null},
  {"dci": "Dapagliflozine", "commercial": ["Forxiga"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Nadroparine", "commercial": ["Fraxiparine"], "category": "Anticoagulant", "image": null},
  {"dci": "Nadroparine", "commercial": ["Fraxodi"], "category": "Anticoagulant", "image": null},
  {"dci": "Acide fusidique + b\u00e9tam\u00e9thasone", "commercial": ["Fucicort"], "category": "Antibiotique", "image": null},
  {"dci": "Acide fusidique", "commercial": ["Fucidin"], "category": "Antibiotique", "image": null},
  {"dci": "Nitrofuranto\u00efne", "commercial": ["Furadantine"], "category": "Antibiotique", "image": null},
  {"dci": "Gabapentine", "commercial": ["Gabaran"], "category": "Anti\u00e9pileptique", "image": null},
  {"dci": "Alginate de sodium + bicarbonate", "commercial": ["Gaviscon"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Acide hyaluronique", "commercial": ["Gengigel"], "category": "Autre", "image": null},
  {"dci": "Triazolam", "commercial": ["Halcion"], "category": "Anxiolytique", "image": null},
  {"dci": "Halop\u00e9ridol", "commercial": ["Haldol"], "category": "Antipsychotique", "image": null},
  {"dci": "Hex\u00e9tidine", "commercial": ["Hextril"], "category": "Antiseptique", "image": null},
  {"dci": "Chlorhexidine", "commercial": ["Hibidil"], "category": "Antiseptique", "image": null},
  {"dci": "H\u00e9parino\u00efde", "commercial": ["Hirudoid"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "Extraits v\u00e9g\u00e9taux + borate de sodium", "commercial": ["Hom\u00e9oplasmine"], "category": "Autre", "image": null},
  {"dci": "Hydroxycarbamide", "commercial": ["Hydrea"], "category": "Autre", "image": null},
  {"dci": "Ibuprof\u00e8ne", "commercial": ["Ibuprofen"], "category": "Antalgique", "image": null},
  {"dci": "Lop\u00e9ramide", "commercial": ["Imodium"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Lactobacillus rhamnosus GG", "commercial": ["Imutis"], "category": "Probiotique", "image": null},
  {"dci": "Oxyde de zinc + baume du P\u00e9rou + huile de foie de morue", "commercial": ["Inotyol"], "category": "Autre", "image": null},
  {"dci": "B\u00e9clom\u00e9tasone + formot\u00e9rol", "commercial": ["Inuvair"], "category": "Cortico\u00efde", "image": null},
  {"dci": "Canagliflozine", "commercial": ["Invokana"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Sitagliptine", "commercial": ["Januvia"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Empagliflozine", "commercial": ["Jardiance"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Bud\u00e9sonide", "commercial": ["Jorveza"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "L\u00e9v\u00e9tirac\u00e9tam", "commercial": ["Keppra"], "category": "Anti\u00e9pileptique", "image": null},
  {"dci": "Carv\u00e9dilol", "commercial": ["Kredex"], "category": "Antihypertenseur", "image": null},
  {"dci": "Lamotrigine", "commercial": ["Lamictal"], "category": "Anti\u00e9pileptique", "image": null},
  {"dci": "Insuline glargine", "commercial": ["Lantus"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Furos\u00e9mide", "commercial": ["Lasix"], "category": "Antihypertenseur", "image": null},
  {"dci": "Macrogol + sels", "commercial": ["Laxido"], "category": "Laxatif", "image": null},
  {"dci": "Picosulfate de sodium", "commercial": ["Laxoberon"], "category": "Laxatif", "image": null},
  {"dci": "M\u00e9thotrexate", "commercial": ["Ledertrexate"], "category": "Immunosuppresseur", "image": null},
  {"dci": "Bromaz\u00e9pam", "commercial": ["Lexotan"], "category": "Anxiolytique", "image": null},
  {"dci": "Baclof\u00e8ne", "commercial": ["Lioresal"], "category": "Autre", "image": null},
  {"dci": "F\u00e9nofibrate", "commercial": ["Lipanthylano"], "category": "Hypolip\u00e9miant", "image": null},
  {"dci": "Atorvastatine", "commercial": ["Lipitor"], "category": "Hypolip\u00e9miant", "image": null},
  {"dci": "Alizapride", "commercial": ["Litican"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Edoxaban", "commercial": ["Lixiana"], "category": "Anticoagulant", "image": null},
  {"dci": "Indapamide", "commercial": ["Lodixal"], "category": "Antihypertenseur", "image": null},
  {"dci": "Lorm\u00e9taz\u00e9pam", "commercial": ["Loramet"], "category": "Anxiolytique", "image": null},
  {"dci": "Gluconate ferreux", "commercial": ["Losferron"], "category": "Autre", "image": null},
  {"dci": "Pr\u00e9gabaline", "commercial": ["Lyrica"], "category": "Autre", "image": null},
  {"dci": "Praz\u00e9pam", "commercial": ["Lysanxia"], "category": "Anxiolytique", "image": null},
  {"dci": "Ac\u00e9tylcyst\u00e9ine", "commercial": ["Lysomucil"], "category": "Respiratoire", "image": null},
  {"dci": "Pholcodine", "commercial": ["Lysotossil"], "category": "Respiratoire", "image": null},
  {"dci": "Dexam\u00e9thasone + n\u00e9omycine + polymyxine B", "commercial": ["Maxitrol"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "M\u00e9thylprednisolone", "commercial": ["Medrol"], "category": "Cortico\u00efde", "image": null},
  {"dci": "M\u00e9mantine", "commercial": ["M\u00e9mantine"], "category": "Autre", "image": null},
  {"dci": "M\u00e9loxicam", "commercial": ["Meloxidyl"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "Pyridostigmine", "commercial": ["Mestinon"], "category": "Autre", "image": null},
  {"dci": "Metformine", "commercial": ["Metformax"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Citrate de sodium + laurylsulfoac\u00e9tate", "commercial": ["Microlax"], "category": "Laxatif", "image": null},
  {"dci": "Trinitrine", "commercial": ["Minitran"], "category": "Autre", "image": null},
  {"dci": "Macrogol + sels", "commercial": ["Molaxole"], "category": "Laxatif", "image": null},
  {"dci": "Latanoprost", "commercial": ["Monoprost"], "category": "Ophtalmologie", "image": null},
  {"dci": "Fosfomycine", "commercial": ["Monuril"], "category": "Antibiotique", "image": null},
  {"dci": "Domp\u00e9ridone", "commercial": ["Motilium"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Macrogol + sels", "commercial": ["Movicol"], "category": "Laxatif", "image": null},
  {"dci": "Trinitrine", "commercial": ["Myrosor"], "category": "Autre", "image": null},
  {"dci": "Bacitracine + n\u00e9omycine", "commercial": ["Neobacitracine"], "category": "Antibiotique", "image": null},
  {"dci": "Oxym\u00e9tazoline", "commercial": ["Nesivine"], "category": "Autre", "image": null},
  {"dci": "\u00c9som\u00e9prazole", "commercial": ["Nexiam"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Acide bemp\u00e9do\u00efque", "commercial": ["Nilemdo"], "category": "Hypolip\u00e9miant", "image": null},
  {"dci": "K\u00e9toconazole", "commercial": ["Nizoral"], "category": "Antifongique", "image": null},
  {"dci": "Indapamide + p\u00e9rindopril", "commercial": ["Nobiretic"], "category": "Antihypertenseur", "image": null},
  {"dci": "N\u00e9bivolol", "commercial": ["Nobiten"], "category": "Antihypertenseur", "image": null},
  {"dci": "Insuline asparte", "commercial": ["Novomix"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "R\u00e9paglinide", "commercial": ["Novonorm"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Insuline asparte", "commercial": ["Novorapid"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Zolpidem", "commercial": ["Noxarem"], "category": "Hypnotique", "image": null},
  {"dci": "Ibuprof\u00e8ne", "commercial": ["Nurofen"], "category": "Antalgique", "image": null},
  {"dci": "Potassium + magn\u00e9sium", "commercial": ["Nustasium"], "category": "Autre", "image": null},
  {"dci": "Acide bemp\u00e9do\u00efque + \u00e9z\u00e9timibe", "commercial": ["Nustendi"], "category": "Hypolip\u00e9miant", "image": null},
  {"dci": "Xylom\u00e9tazoline", "commercial": ["Otrivine"], "category": "Autre", "image": null},
  {"dci": "Oxycodone", "commercial": ["Oxynorm"], "category": "Antalgique opio\u00efde", "image": null},
  {"dci": "S\u00e9maglutide", "commercial": ["Ozempic"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Hydromorphone", "commercial": ["Palladone"], "category": "Antalgique opio\u00efde", "image": null},
  {"dci": "Parac\u00e9tamol", "commercial": ["Panadol"], "category": "Antalgique", "image": null},
  {"dci": "Fluocinolone + n\u00e9omycine + polymyxine B + lidoca\u00efne", "commercial": ["Panotile"], "category": "Autre", "image": null},
  {"dci": "Pantoprazole", "commercial": ["Pantomed"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Cod\u00e9ine", "commercial": ["Paracodine"], "category": "Respiratoire", "image": null},
  {"dci": "Vermifuge chiens et chats", "commercial": ["Parazan"], "category": "Autre", "image": null},
  {"dci": "Ibuprof\u00e8ne", "commercial": ["Perdofemina"], "category": "Autre", "image": null},
  {"dci": "Parac\u00e9tamol + caf\u00e9ine (ou cod\u00e9ine selon version)", "commercial": ["Perdolan"], "category": "Autre", "image": null},
  {"dci": "P\u00e9rindopril + indapamide", "commercial": ["Preterax"], "category": "Antihypertenseur", "image": null},
  {"dci": "Vaccin pneumocoque conjugu\u00e9", "commercial": ["Prevenar"], "category": "Vaccin", "image": null},
  {"dci": "L\u00e9vodopa + bens\u00e9razide", "commercial": ["Prolopa"], "category": "Antiparkinsonien", "image": null},
  {"dci": "Lactobacillus reuteri", "commercial": ["Protectis"], "category": "Probiotique", "image": null},
  {"dci": "Hydrogel", "commercial": ["Purilon"], "category": "Dermatologie", "image": null},
  {"dci": "Amitriptyline", "commercial": ["Redomex"], "category": "Antid\u00e9presseur", "image": null},
  {"dci": "Fluticasone + vilant\u00e9rol", "commercial": ["Relvar"], "category": "Cortico\u00efde", "image": null},
  {"dci": "Mirtazapine", "commercial": ["Remergon"], "category": "Antid\u00e9presseur", "image": null},
  {"dci": "Carbonate de calcium + magn\u00e9sium", "commercial": ["Rennie"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Escine", "commercial": ["Reparil"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "Acides amin\u00e9s + vitamines", "commercial": ["Revitalose"], "category": "Autre", "image": null},
  {"dci": "Carbocyst\u00e9ine", "commercial": ["Rhinathiol"], "category": "Respiratoire", "image": null},
  {"dci": "Chlorure de sodium", "commercial": ["Rhinicur"], "category": "Autre", "image": null},
  {"dci": "Parac\u00e9tamol + chlorph\u00e9namine", "commercial": ["Rhinofebryl"], "category": "Autre", "image": null},
  {"dci": "Solution saline / huiles essentielles", "commercial": ["Rhinovita"], "category": "Autre", "image": null},
  {"dci": "M\u00e9thylph\u00e9nidate", "commercial": ["Rilatine"], "category": "Autre", "image": null},
  {"dci": "Magaldrate", "commercial": ["Riopan"], "category": "Gastro-intestinal", "image": null},
  {"dci": "Risp\u00e9ridone", "commercial": ["Risperdal"], "category": "Antipsychotique", "image": null},
  {"dci": "Clonaz\u00e9pam", "commercial": ["Rivotril"], "category": "Anxiolytique", "image": null},
  {"dci": "Vaccin anti-rotavirus", "commercial": ["Rotarix"], "category": "Vaccin", "image": null},
  {"dci": "Rupatadine", "commercial": ["Rupatall"], "category": "Antiallergique", "image": null},
  {"dci": "Olopatadine + mom\u00e9tasone", "commercial": ["Ryaltris"], "category": "Autre", "image": null},
  {"dci": "S\u00e9maglutide", "commercial": ["Rybelsus"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Fluocortolone + cinchoca\u00efne", "commercial": ["Scheriproct"], "category": "Autre", "image": null},
  {"dci": "Acide ac\u00e9tylsalicylique + antiacide", "commercial": ["Sedergine"], "category": "Antalgique", "image": null},
  {"dci": "Sertraline", "commercial": ["Serlain"], "category": "Antid\u00e9presseur", "image": null},
  {"dci": "Qu\u00e9tiapine", "commercial": ["Seroquel"], "category": "Antipsychotique", "image": null},
  {"dci": "Parox\u00e9tine", "commercial": ["Seroxat"], "category": "Antid\u00e9presseur", "image": null},
  {"dci": "Pramipexole", "commercial": ["Sifrol"], "category": "Antiparkinsonien", "image": null},
  {"dci": "Ac\u00e9nocoumarol", "commercial": ["Sintrom"], "category": "Anticoagulant", "image": null},
  {"dci": "Parac\u00e9tamol + pseudo\u00e9ph\u00e9drine + chlorph\u00e9namine", "commercial": ["Sinutab"], "category": "Autre", "image": null},
  {"dci": "Escitalopram", "commercial": ["Sipralexa"], "category": "Antid\u00e9presseur", "image": null},
  {"dci": "Ac\u00e9tylcyst\u00e9ine", "commercial": ["Siroxyl"], "category": "Respiratoire", "image": null},
  {"dci": "B\u00eata\u00e9thasone + n\u00e9omycine + polymyxine B", "commercial": ["Sofrasolone"], "category": "Autre", "image": null},
  {"dci": "Otilonium", "commercial": ["Spasmomen"], "category": "Autre", "image": null},
  {"dci": "Ibuprof\u00e8ne", "commercial": ["Spidifen"], "category": "Antalgique", "image": null},
  {"dci": "Acide fusidique", "commercial": ["Staphycid"], "category": "Antibiotique", "image": null},
  {"dci": "Peroxyde / nettoyant enzymatique", "commercial": ["Steradent"], "category": "Autre", "image": null},
  {"dci": "Eau de mer st\u00e9rile", "commercial": ["Sterimar"], "category": "Autre", "image": null},
  {"dci": "Flurbiprof\u00e8ne", "commercial": ["Strepfen"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "Amylm\u00e9tacr\u00e9sol + alcool dichlorobenzylique", "commercial": ["Strepsils"], "category": "Antiseptique", "image": null},
  {"dci": "Empagliflozine + linagliptine", "commercial": ["Suvezen"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Bud\u00e9sonide + formot\u00e9rol", "commercial": ["Symbicort"], "category": "Cortico\u00efde", "image": null},
  {"dci": "Sulfate ferreux", "commercial": ["Tardyferon"], "category": "Autre", "image": null},
  {"dci": "G\u00e9latine tanate", "commercial": ["Tasectan"], "category": "Autre", "image": null},
  {"dci": "Vitamines B + min\u00e9raux", "commercial": ["Tavaforce"], "category": "Autre", "image": null},
  {"dci": "Carbamaz\u00e9pine", "commercial": ["Tegretol"], "category": "Anti\u00e9pileptique", "image": null},
  {"dci": "Loraz\u00e9pam", "commercial": ["Temesta"], "category": "Anxiolytique", "image": null},
  {"dci": "Huile essentielle de menthe poivr\u00e9e", "commercial": ["Tempocol"], "category": "Autre", "image": null},
  {"dci": "M\u00e9toprolol", "commercial": ["Tenomed"], "category": "Antihypertenseur", "image": null},
  {"dci": "Oxyt\u00e9tracycline", "commercial": ["Terramycine"], "category": "Antibiotique", "image": null},
  {"dci": "Tr\u00e9halose", "commercial": ["Thealoz"], "category": "Ophtalmologie", "image": null},
  {"dci": "Diltiazem", "commercial": ["Tildiem"], "category": "Antihypertenseur", "image": null},
  {"dci": "Tobramycine + dexam\u00e9thasone", "commercial": ["Tobradex"], "category": "Antibiotique", "image": null},
  {"dci": "Tobramycine", "commercial": ["Tobrex"], "category": "Antibiotique", "image": null},
  {"dci": "Atorvastatine", "commercial": ["Totalip"], "category": "Hypolip\u00e9miant", "image": null},
  {"dci": "Insuline glargine", "commercial": ["Toujeo"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Ambroxol + lidoca\u00efne (selon formule)", "commercial": ["Toularynx"], "category": "Autre", "image": null},
  {"dci": "Tramadol", "commercial": ["Tradonal"], "category": "Antalgique opio\u00efde", "image": null},
  {"dci": "Bupr\u00e9norphine", "commercial": ["Transtec"], "category": "Antalgique opio\u00efde", "image": null},
  {"dci": "Complexe hom\u00e9opathique", "commercial": ["Traumeel"], "category": "Autre", "image": null},
  {"dci": "Fluticasone + vilant\u00e9rol + um\u00e9clidinium", "commercial": ["Trelegy"], "category": "Autre", "image": null},
  {"dci": "Fluocortolone + cinchoca\u00efne", "commercial": ["Trianal"], "category": "Autre", "image": null},
  {"dci": "Complexe vitamines B1-B6-B12", "commercial": ["Tribvit"], "category": "Autre", "image": null},
  {"dci": "B\u00e9clom\u00e9tasone + formot\u00e9rol + glycopyrronium", "commercial": ["Trimbow"], "category": "Autre", "image": null},
  {"dci": "Dulaglutide", "commercial": ["Trulicity"], "category": "Antidiab\u00e9tique", "image": null},
  {"dci": "Extrait de canneberge", "commercial": ["Uri-Cran"], "category": "Autre", "image": null},
  {"dci": "Salbutamol", "commercial": ["Ventolin"], "category": "Bronchodilatateur", "image": null},
  {"dci": "Propentofylline", "commercial": ["Vitofyllin"], "category": "Autre", "image": null},
  {"dci": "Diclof\u00e9nac", "commercial": ["Voltaren"], "category": "Anti-inflammatoire (AINS)", "image": null},
  {"dci": "Latanoprost", "commercial": ["Xalatan"], "category": "Ophtalmologie", "image": null},
  {"dci": "Alprazolam", "commercial": ["Xanax"], "category": "Anxiolytique", "image": null},
  {"dci": "Solution saline / huile essentielle", "commercial": ["Xylomaris"], "category": "Autre", "image": null},
  {"dci": "Tramadol + parac\u00e9tamol", "commercial": ["Zaldiar"], "category": "Antalgique opio\u00efde", "image": null},
  {"dci": "Perm\u00e9thrine", "commercial": ["Zalvor"], "category": "Autre", "image": null},
  {"dci": "Lercanidipine", "commercial": ["Zanidip"], "category": "Antihypertenseur", "image": null},
  {"dci": "C\u00e9furoxime", "commercial": ["Zinnat"], "category": "Antibiotique", "image": null},
  {"dci": "Azithromycine", "commercial": ["Zitromax"], "category": "Antibiotique", "image": null},
  {"dci": "Simvastatine", "commercial": ["Zocor"], "category": "Hypolip\u00e9miant", "image": null},
  {"dci": "Zopiclone", "commercial": ["Zopiclone"], "category": "Hypnotique", "image": null},
  {"dci": "Allopurinol", "commercial": ["Zyloric"], "category": "Autre", "image": null},
  {"dci": "C\u00e9tirizine", "commercial": ["Zyrtec"], "category": "Antiallergique", "image": null}
];

const INITIAL_CLASSES = {
  "Antalgique": "#3B82F6",
  "Antalgique opio√Øde": "#EF4444",
  "Anti-inflammatoire (AINS)": "#10B981",
  "Antiallergique": "#F59E0B",
  "Antiarythmique": "#8B5CF6",
  "Antibiotique": "#EC4899",
  "Anticoagulant": "#14B8A6",
  "Antidiab√©tique": "#F97316",
  "Antid√©presseur": "#6366F1",
  "Antifongique": "#84CC16",
  "Antihypertenseur": "#06B6D4",
  "Antiparkinsonien": "#D946EF",
  "Antipsychotique": "#0EA5E9",
  "Antiseptique": "#F43F5E",
  "Anti√©pileptique": "#A855F7",
  "Anxiolytique": "#22C55E",
  "Autre": "#EAB308",
  "Bronchodilatateur": "#DC2626",
  "Cortico√Øde": "#2563EB",
  "Dermatologie": "#16A34A",
  "Diur√©tique": "#CA8A04",
  "Gastro-intestinal": "#9333EA",
  "Hypnotique": "#0891B2",
  "Hypolip√©miant": "#DB2777",
  "Immunosuppresseur": "#64748b",
  "Laxatif": "#3B82F6",
  "Ophtalmologie": "#EF4444",
  "Probiotique": "#10B981",
  "Respiratoire": "#F59E0B",
  "Vaccin": "#8B5CF6",
  "Non attribu√©e": "#9CA3AF"
};

function PharmaQuizz() {
  
  const [mode, setMode] = useState('menu');
  const [medications, setMedications] = useState(() => {
    const saved = localStorage.getItem('pharmaquizz_medications');
    return saved ? JSON.parse(saved) : INITIAL_MEDS;
  });
  const [therapeuticClasses, setTherapeuticClasses] = useState(() => {
    const saved = localStorage.getItem('pharmaquizz_classes');
    return saved ? JSON.parse(saved) : INITIAL_CLASSES;
  });
  const [shuffledMeds, setShuffledMeds] = useState([]);
  const [currentIndex, setCurrentIndex] = useState(0);
  const [showAnswer, setShowAnswer] = useState(false);
  const [flashcardView, setFlashcardView] = useState('card');
  const [showSettings, setShowSettings] = useState(false);
  const [showManagement, setShowManagement] = useState(false);
  
  const [selectionMode, setSelectionMode] = useState('all');
  const [selectedClasses, setSelectedClasses] = useState([]);
  const [selectedMeds, setSelectedMeds] = useState([]);
  const [quizCardCount, setQuizCardCount] = useState(10);
  const [stats, setStats] = useState({ correct: 0, total: 0 });
  const [userAnswer, setUserAnswer] = useState('');
  const [showQuizFeedback, setShowQuizFeedback] = useState(false);
  const [quizHistory, setQuizHistory] = useState([]);
  const [showQuizHistory, setShowQuizHistory] = useState(false);
  const [currentQuizStart, setCurrentQuizStart] = useState(null);
  const [sortBy, setSortBy] = useState('dci');
  const [filterCategory, setFilterCategory] = useState('all');
  const [editingIndex, setEditingIndex] = useState(null);
  const [customMed, setCustomMed] = useState({ dci: '', commercial: '', category: '', image: null });
  const [searchQuery, setSearchQuery] = useState('');
  const [errorMessage, setErrorMessage] = useState('');
  const [showClassManager, setShowClassManager] = useState(false);
  const [newClassName, setNewClassName] = useState('');
  const [newClassColor, setNewClassColor] = useState('#64748b');
  const [editingClass, setEditingClass] = useState(null);
  const [flashcardListSort, setFlashcardListSort] = useState('dci');
  const [showDataManagement, setShowDataManagement] = useState(false);

  const currentMed = shuffledMeds[currentIndex];

  // Sauvegarde automatique
  React.useEffect(() => {
    localStorage.setItem('pharmaquizz_medications', JSON.stringify(medications));
  }, [medications]);

  React.useEffect(() => {
    localStorage.setItem('pharmaquizz_classes', JSON.stringify(therapeuticClasses));
  }, [therapeuticClasses]);

  // ========== ALGORITHME SRS ==========
  

  

  

  // ========== STATISTIQUES ==========
  

  // ========== FONCTIONS UTILITAIRES ==========
  const normalizeString = (str) => str.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/[^a-z0-9]/g, "");

  const levenshteinDistance = (str1, str2) => {
    const matrix = [];
    for (let i = 0; i <= str2.length; i++) matrix[i] = [i];
    for (let j = 0; j <= str1.length; j++) matrix[0][j] = j;
    for (let i = 1; i <= str2.length; i++) {
      for (let j = 1; j <= str1.length; j++) {
        matrix[i][j] = str2.charAt(i - 1) === str1.charAt(j - 1) ? matrix[i - 1][j - 1] : Math.min(matrix[i - 1][j - 1] + 1, matrix[i][j - 1] + 1, matrix[i - 1][j] + 1);
      }
    }
    return matrix[str2.length][str1.length];
  };

  const checkAnswer = (userAns, correctAns) => {
    const normalized1 = normalizeString(userAns);
    const normalized2 = normalizeString(correctAns);
    return levenshteinDistance(normalized1, normalized2) <= Math.floor(normalized2.length * 0.2);
  };

  const getCategories = () => [...new Set(medications.map(med => med.category))].sort();
  const getClassColor = (className) => therapeuticClasses[className] || '#64748b';

  const getSortedMedications = () => {
    let sorted = [...medications];
    if (searchQuery.trim()) {
      const query = searchQuery.toLowerCase();
      sorted = sorted.filter(med => 
        med.dci.toLowerCase().includes(query) ||
        med.commercial.some(name => name.toLowerCase().includes(query)) ||
        med.category.toLowerCase().includes(query)
      );
    }
    if (filterCategory !== 'all') sorted = sorted.filter(med => med.category === filterCategory);
    switch(sortBy) {
      case 'dci': sorted.sort((a, b) => a.dci.localeCompare(b.dci)); break;
      case 'commercial': sorted.sort((a, b) => a.commercial[0].localeCompare(b.commercial[0])); break;
      case 'category': sorted.sort((a, b) => a.category.localeCompare(b.category)); break;
    }
    return sorted;
  };

  const getFlashcardListMedications = () => {
    let sorted = [...shuffledMeds];
    if (searchQuery.trim()) {
      const query = searchQuery.toLowerCase();
      sorted = sorted.filter(med => 
        med.dci.toLowerCase().includes(query) ||
        med.commercial.some(name => name.toLowerCase().includes(query)) ||
        med.category.toLowerCase().includes(query)
      );
    }
    switch(flashcardListSort) {
      case 'dci': sorted.sort((a, b) => a.dci.localeCompare(b.dci)); break;
      case 'commercial': sorted.sort((a, b) => a.commercial[0].localeCompare(b.commercial[0])); break;
      case 'category': sorted.sort((a, b) => a.category.localeCompare(b.category)); break;
    }
    return sorted;
  };

  const handleQuizSubmit = (e) => {
    e.preventDefault();
    if (!userAnswer.trim()) return;
    const isCorrect = checkAnswer(userAnswer, currentMed.dci);
    setShowQuizFeedback(true);
    setStats({ correct: stats.correct + (isCorrect ? 1 : 0), total: stats.total + 1 });
  };

  const handleNext = () => {
    if (currentIndex < shuffledMeds.length - 1) {
      setCurrentIndex(currentIndex + 1);
      setShowAnswer(false);
      if (mode === 'quiz') {
        setUserAnswer('');
        setShowQuizFeedback(false);
      }
    } else {
      if (mode === 'quiz' && currentQuizStart) {
        setQuizHistory([{
          date: currentQuizStart,
          score: stats.correct,
          total: stats.total,
          percentage: Math.round((stats.correct / stats.total) * 100),
          completed: true
        }, ...quizHistory]);
      }
      setMode('menu');
      setShuffledMeds([]);
    }
  };

  const applySelection = () => {
    let medsToUse = [];
    
    if (selectionMode === 'all') {
      medsToUse = [...medications];
    } else if (selectionMode === 'class') {
      medsToUse = medications.filter(med => selectedClasses.includes(med.category));
    } else if (selectionMode === 'custom') {
      medsToUse = selectedMeds.map(i => medications[i]);
    }
    
    if (medsToUse.length === 0) {
      alert('Aucun m√©dicament s√©lectionn√©');
      return;
    }
    
    // Pour le quiz : limiter au nombre choisi
    if (mode === 'quiz' && selectionMode !== 'custom') {
      const shuffled = [...medsToUse].sort(() => Math.random() - 0.5);
      medsToUse = shuffled.slice(0, Math.min(quizCardCount, medsToUse.length));
    }
    
    setShuffledMeds([...medsToUse].sort(() => Math.random() - 0.5));
    setCurrentIndex(0);
    setShowAnswer(false);
    setStats({ correct: 0, total: 0 });
    setShowSettings(false);
    
    if (mode === 'quiz') {
      setCurrentQuizStart(new Date());
      setUserAnswer('');
      setShowQuizFeedback(false);
    }
  };

  const startMode = (newMode) => {
    setMode(newMode);
    setSelectionMode('all');
    setSelectedClasses([]);
    setSelectedMeds([]);
    setQuizCardCount(10);
    
    if (newMode === 'quiz') {
      setShowSettings(true);
    } else {
      const medsToUse = [...medications];
      setShuffledMeds([...medsToUse].sort(() => Math.random() - 0.5));
      setCurrentIndex(0);
      setShowAnswer(false);
      setStats({ correct: 0, total: 0 });
      setSearchQuery('');
      if (newMode === 'flashcard') {
        setFlashcardView('card');
      }
    }
  };

  

  const startEditMedication = (index) => {
    const med = medications[index];
    setCustomMed({ dci: med.dci, commercial: med.commercial.join(', '), category: med.category, image: med.image });
    setEditingIndex(index);
  };

  const cancelEdit = () => {
    setEditingIndex(null);
    setCustomMed({ dci: '', commercial: '', category: '', image: null });
    setErrorMessage('');
    setShowClassManager(false);
    setEditingClass(null);
  };

  const saveMedication = () => {
    if (!customMed.dci || !customMed.commercial || !customMed.category) {
      setErrorMessage('‚ö†Ô∏è Veuillez remplir tous les champs obligatoires (DCI, Nom commercial, Classe)');
      setTimeout(() => setErrorMessage(''), 3000);
      return;
    }
    
    const newMed = {
      dci: customMed.dci,
      commercial: customMed.commercial.split(',').map(s => s.trim()).filter(s => s),
      category: customMed.category,
      image: customMed.image
    };
    
    if (editingIndex !== null) {
      const updated = [...medications];
      newMed.nextReview = medications[editingIndex].nextReview;
      newMed.interval = medications[editingIndex].interval;
      updated[editingIndex] = newMed;
      setMedications(updated);
      setEditingIndex(null);
    } else {
      setMedications([...medications, newMed]);
    }
    setCustomMed({ dci: '', commercial: '', category: '', image: null });
    setErrorMessage('');
  };

  const handleImageUpload = (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onloadend = () => setCustomMed({...customMed, image: reader.result});
      reader.readAsDataURL(file);
    }
  };

  const addNewClass = () => {
    if (!newClassName.trim()) {
      setErrorMessage('‚ö†Ô∏è Veuillez entrer un nom de classe');
      setTimeout(() => setErrorMessage(''), 3000);
      return;
    }
    if (getCategories().includes(newClassName.trim())) {
      setErrorMessage('‚ö†Ô∏è Cette classe existe d√©j√†');
      setTimeout(() => setErrorMessage(''), 3000);
      return;
    }
    setTherapeuticClasses({...therapeuticClasses, [newClassName.trim()]: newClassColor});
    setCustomMed({...customMed, category: newClassName.trim()});
    setNewClassName('');
    setNewClassColor('#64748b');
    setShowClassManager(false);
    setErrorMessage('');
  };

  const updateClass = (oldName, newName, newColor) => {
    if (!newName.trim()) {
      setErrorMessage('‚ö†Ô∏è Veuillez entrer un nom de classe');
      setTimeout(() => setErrorMessage(''), 3000);
      return;
    }
    if (newName !== oldName && getCategories().includes(newName.trim())) {
      setErrorMessage('‚ö†Ô∏è Cette classe existe d√©j√†');
      setTimeout(() => setErrorMessage(''), 3000);
      return;
    }
    const updatedClasses = {...therapeuticClasses};
    delete updatedClasses[oldName];
    updatedClasses[newName.trim()] = newColor;
    setTherapeuticClasses(updatedClasses);
    const updatedMeds = medications.map(med => 
      med.category === oldName ? {...med, category: newName.trim()} : med
    );
    setMedications(updatedMeds);
    setEditingClass(null);
    setErrorMessage('');
  };

  
  const resetToDefault = () => {
    if (window.confirm('‚ö†Ô∏è √ätes-vous s√ªr de vouloir r√©initialiser TOUTES vos donn√©es ? Cette action est irr√©versible.')) {
      localStorage.removeItem('pharmaquizz_medications');
      localStorage.removeItem('pharmaquizz_classes');
      setMedications(INITIAL_MEDS);
      setTherapeuticClasses(INITIAL_CLASSES);
      alert('‚úÖ R√©initialisation termin√©e !\n\nüîÑ Retour aux 7 m√©dicaments par d√©faut\nüí° Pensez √† exporter avant de r√©initialiser la prochaine fois !');
    }
  };

  const exportData = () => {
    const data = { medications, therapeuticClasses, exportDate: new Date().toISOString() };
    const json = JSON.stringify(data, null, 2);
    const blob = new Blob([json], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `pharmaquizz_backup_${new Date().toISOString().split('T')[0]}.json`;
        alert('‚úÖ Sauvegarde t√©l√©charg√©e !\n\nüìÅ Fichier : pharmaquizz_backup_' + new Date().toISOString().split('T')[0] + '.json\nüíæ Gardez ce fichier pr√©cieusement !\nüì§ Vous pouvez le partager avec vos coll√®gues.');
    a.click();
    URL.revokeObjectURL(url);
  };

  const importData = (event) => {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const data = JSON.parse(e.target.result);
          if (data.medications && data.therapeuticClasses) {
            setMedications(data.medications);
            setTherapeuticClasses(data.therapeuticClasses);
            alert('‚úÖ Donn√©es import√©es avec succ√®s !\n\nüìä ' + data.medications.length + ' m√©dicaments charg√©s\nüé® ' + Object.keys(data.therapeuticClasses).length + ' classes th√©rapeutiques');
          } else {
            alert('‚ùå Fichier invalide');
          }
        } catch (err) {
          alert('‚ùå Erreur lors de l\'import : ' + err.message);
        }
      };
      reader.readAsText(file);
    }
  };

  const ImagePlaceholder = () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
      <circle cx="8.5" cy="8.5" r="1.5"/>
      <polyline points="21 15 16 10 5 21"/>
    </svg>
  );

  

  return (
    <div style={{ minHeight: '100vh', background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', padding: '1rem' }}>
      <style>{`.button-hover { transition: all 0.3s; } .button-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2); }`}</style>

      <div style={{ maxWidth: '1200px', margin: '0 auto' }}>
        <div style={{ background: 'linear-gradient(135deg, #1e293b 0%, #334155 100%)', padding: '1.5rem', color: 'white', textAlign: 'center', borderRadius: '20px 20px 0 0' }}>
          <h1 style={{ margin: 0, fontSize: '1.8rem', fontWeight: 700 }}>PharmaQuizz</h1>
          <p style={{ margin: '0.5rem 0 0 0', opacity: 0.9, fontSize: '0.85rem' }}>
            {medications.length} m√©dicaments
          </p>
          <div style={{ marginTop: '0.5rem', fontSize: '0.75rem', opacity: 0.7, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem' }}>
            <span style={{ width: '8px', height: '8px', background: '#10B981', borderRadius: '50%', animation: 'pulse 2s infinite' }}></span>
            Sauvegarde automatique activ√©e
          </div>
          {stats.total > 0 && (
            <div style={{ marginTop: '1rem', padding: '0.75rem', background: 'rgba(255, 255, 255, 0.1)', borderRadius: '12px' }}>
              <div style={{ fontSize: '0.85rem', opacity: 0.8 }}>Score</div>
              <div style={{ fontSize: '1.5rem', fontWeight: 700 }}>{Math.round((stats.correct / stats.total) * 100)}% ({stats.correct}/{stats.total})</div>
            </div>
          )}
        </div>

        <div style={{ background: 'white', borderRadius: '0 0 20px 20px', padding: '1.5rem', boxShadow: '0 20px 60px rgba(0, 0, 0, 0.3)', minHeight: '400px' }}>
          
          {mode === 'menu' && (
            <div>
              <h2 style={{ textAlign: 'center', marginBottom: '2rem', color: '#1e293b', fontSize: '1.8rem' }}>Choisissez votre mode</h2>
              
              

              <div style={{ display: 'grid', gap: '1rem', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', marginBottom: '1rem' }}>
                <button onClick={() => startMode('flashcard')} className="button-hover" style={{ background: 'linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)', border: 'none', borderRadius: '16px', padding: '2rem', color: 'white', cursor: 'pointer', position: 'relative', textAlign: 'center' }}>
                  <div style={{ position: 'absolute', top: '2rem', left: '2rem' }}><BookOpen size={24} /></div>
                  <div>
                    <div style={{ fontSize: '1.3rem', fontWeight: 700, marginBottom: '0.5rem' }}>Flashcards</div>
                    <div style={{ fontSize: '0.9rem', opacity: 0.9 }}>Apprentissage</div>
                  </div>
                </button>
                
                <button onClick={() => startMode('quiz')} className="button-hover" style={{ background: 'linear-gradient(135deg, #EF4444 0%, #DC2626 100%)', border: 'none', borderRadius: '16px', padding: '2rem', color: 'white', cursor: 'pointer', position: 'relative', textAlign: 'center' }}>
                  <div style={{ position: 'absolute', top: '2rem', left: '2rem' }}><Brain size={24} /></div>
                  <div>
                    <div style={{ fontSize: '1.3rem', fontWeight: 700, marginBottom: '0.5rem' }}>Quiz</div>
                    <div style={{ fontSize: '0.9rem', opacity: 0.9 }}>Test</div>
                  </div>
                </button>
              </div>

              
            </div>
          )}

          {/* MODE FLASHCARD */}
          {mode === 'flashcard' && currentMed && (
            <div>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem', flexWrap: 'wrap', gap: '1rem' }}>
                <div style={{ fontSize: '0.9rem', color: '#64748b', fontWeight: 600 }}>{currentIndex + 1} / {shuffledMeds.length}</div>
                <div style={{ display: 'flex', gap: '0.5rem' }}>
                  <button onClick={() => setShowSettings(true)} className="button-hover" style={{ padding: '0.6rem', background: '#f1f5f9', border: '2px solid #e2e8f0', borderRadius: '8px', cursor: 'pointer' }}>
                    <Settings size={20} style={{ color: '#64748b' }} />
                  </button>
                  <button onClick={() => setShowManagement(true)} className="button-hover" style={{ padding: '0.6rem', background: '#D1FAE5', border: '2px solid #10B981', borderRadius: '8px', cursor: 'pointer' }}>
                    <Plus size={20} style={{ color: '#10B981' }} />
                  </button>
                  <button onClick={() => setFlashcardView('card')} className="button-hover" style={{ padding: '0.5rem 1rem', background: flashcardView === 'card' ? '#334155' : '#e2e8f0', border: 'none', borderRadius: '8px', color: flashcardView === 'card' ? 'white' : '#64748b', cursor: 'pointer', fontSize: '0.9rem', fontWeight: 600 }}>
                    Carte
                  </button>
                  <button onClick={() => setFlashcardView('list')} className="button-hover" style={{ padding: '0.5rem 1rem', background: flashcardView === 'list' ? '#334155' : '#e2e8f0', border: 'none', borderRadius: '8px', color: flashcardView === 'list' ? 'white' : '#64748b', cursor: 'pointer', fontSize: '0.9rem', fontWeight: 600 }}>
                    Liste
                  </button>
                </div>
              </div>

              {flashcardView === 'card' ? (
                <>
                  <div 
                    onClick={() => setShowAnswer(!showAnswer)} 
                    style={{ 
                      background: showAnswer ? getClassColor(currentMed.category) : 'white', 
                      borderRadius: '20px', 
                      padding: '3rem 2rem', 
                      cursor: 'pointer', 
                      minHeight: '300px', 
                      display: 'flex', 
                      flexDirection: 'column', 
                      alignItems: 'center', 
                      justifyContent: 'center', 
                      transition: 'all 0.4s', 
                      boxShadow: showAnswer ? '0 10px 40px rgba(0, 0, 0, 0.1)' : `0 10px 40px ${getClassColor(currentMed.category)}40`, 
                      border: showAnswer ? 'none' : `3px solid ${getClassColor(currentMed.category)}` 
                    }}
                  >
                    {currentMed.image && !showAnswer && (
                      <img src={currentMed.image} alt={currentMed.dci} style={{ maxWidth: '200px', maxHeight: '150px', objectFit: 'contain', marginBottom: '1rem', borderRadius: '12px' }} />
                    )}
                    <div style={{ fontSize: '0.85rem', color: showAnswer ? 'rgba(255, 255, 255, 0.9)' : getClassColor(currentMed.category), marginBottom: '1rem', textTransform: 'uppercase', letterSpacing: '0.1em', fontWeight: 700 }}>
                      {showAnswer ? 'DCI' : 'Nom Commercial'}
                    </div>
                    <div style={{ fontSize: showAnswer ? '2.5rem' : '1.8rem', fontWeight: 700, color: showAnswer ? 'white' : '#1e293b', marginBottom: '1rem', textAlign: 'center' }}>
                      {showAnswer ? currentMed.dci : currentMed.commercial.join(' ‚Ä¢ ')}
                    </div>
                    <div style={{ display: 'inline-block', padding: '0.5rem 1.5rem', background: showAnswer ? 'rgba(255, 255, 255, 0.2)' : `${getClassColor(currentMed.category)}20`, borderRadius: '20px', color: showAnswer ? 'white' : getClassColor(currentMed.category), fontSize: '0.85rem', fontWeight: 600 }}>
                      {currentMed.category}
                    </div>
                  </div>
                  
                  <div style={{ display: 'flex', gap: '1rem', marginTop: '2rem' }}>
                    <button onClick={() => currentIndex > 0 && (setCurrentIndex(currentIndex - 1), setShowAnswer(false))} disabled={currentIndex === 0} className="button-hover" style={{ flex: 1, padding: '1rem', background: currentIndex === 0 ? '#f1f5f9' : '#e2e8f0', border: 'none', borderRadius: '12px', color: currentIndex === 0 ? '#cbd5e1' : '#1e293b', cursor: currentIndex === 0 ? 'not-allowed' : 'pointer', fontWeight: 600, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem' }}>
                      <ChevronLeft size={20} />
                      <span>Pr√©c√©dent</span>
                    </button>
                    <button onClick={() => setMode('menu')} className="button-hover" style={{ flex: 1, padding: '1rem', background: '#e2e8f0', border: 'none', borderRadius: '12px', color: '#1e293b', cursor: 'pointer', fontWeight: 600 }}>
                      Menu
                    </button>
                    <button onClick={handleNext} className="button-hover" style={{ flex: 1, padding: '1rem', background: '#334155', border: 'none', borderRadius: '12px', color: 'white', cursor: 'pointer', fontWeight: 600, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem' }}>
                      <span>Suivant</span>
                      <ChevronRight size={20} />
                    </button>
                  </div>
                </>
              ) : (
                <div>
                  <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>
                    <input type="text" value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} placeholder="üîç Rechercher..." style={{ flex: 1, padding: '0.75rem', border: '2px solid #e2e8f0', borderRadius: '8px', fontSize: '0.9rem' }} />
                    <select value={flashcardListSort} onChange={(e) => setFlashcardListSort(e.target.value)} style={{ padding: '0.75rem', border: '2px solid #e2e8f0', borderRadius: '8px', fontSize: '0.9rem', cursor: 'pointer', background: 'white' }}>
                      <option value="dci">Tri: DCI A-Z</option>
                      <option value="commercial">Tri: Commercial A-Z</option>
                      <option value="category">Tri: Par classe</option>
                    </select>
                  </div>
                  <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
                    {getFlashcardListMedications().map((med, i) => (
                      <div key={i} style={{ padding: '1rem', background: 'white', border: `3px solid ${getClassColor(med.category)}`, borderRadius: '12px', marginBottom: '0.75rem', display: 'flex', gap: '1rem' }}>
                        {med.image ? (
                          <img src={med.image} alt={med.dci} style={{ width: '60px', height: '60px', objectFit: 'cover', borderRadius: '8px', border: `2px solid ${getClassColor(med.category)}` }} />
                        ) : (
                          <div style={{ width: '60px', height: '60px', background: '#f1f5f9', borderRadius: '8px', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#cbd5e1' }}>
                            <ImagePlaceholder />
                          </div>
                        )}
                        <div style={{ flex: 1 }}>
                          <div style={{ fontSize: '1rem', fontWeight: 700, color: '#1e293b' }}>{med.commercial.join(' ‚Ä¢ ')}</div>
                          <div style={{ fontSize: '0.9rem', color: '#64748b' }}>{med.dci}</div>
                          
                        </div>
                      </div>
                    ))}
                  </div>
                  <button onClick={() => setMode('menu')} className="button-hover" style={{ width: '100%', marginTop: '1rem', padding: '1rem', background: '#e2e8f0', border: 'none', borderRadius: '12px', color: '#1e293b', cursor: 'pointer', fontWeight: 600 }}>
                    Menu
                  </button>
                </div>
              )}
            </div>
          )}

          {/* MODE QUIZ */}
          {mode === 'quiz' && currentMed && (
            <div>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1.5rem' }}>
                <div style={{ fontSize: '0.9rem', color: '#64748b', fontWeight: 600 }}>Question {currentIndex + 1} / {shuffledMeds.length}</div>
                <div style={{ display: 'flex', gap: '0.5rem' }}>
                  <button onClick={() => setMode('menu')} className="button-hover" style={{ padding: '0.6rem 1rem', background: '#e2e8f0', border: '2px solid #cbd5e1', borderRadius: '8px', cursor: 'pointer', fontWeight: 600, color: '#1e293b', fontSize: '0.9rem' }}>
                    Menu
                  </button>
                  <button onClick={() => setShowSettings(true)} className="button-hover" style={{ padding: '0.6rem', background: '#f1f5f9', border: '2px solid #e2e8f0', borderRadius: '8px', cursor: 'pointer' }}>
                    <Settings size={20} style={{ color: '#64748b' }} />
                  </button>
                </div>
              </div>

              <div style={{ background: 'white', border: `3px solid ${getClassColor(currentMed.category)}`, borderRadius: '20px', padding: '2rem', marginBottom: '1.5rem' }}>
                {currentMed.image && (
                  <img src={currentMed.image} alt="M√©dicament" style={{ maxWidth: '200px', maxHeight: '150px', objectFit: 'contain', display: 'block', margin: '0 auto 1.5rem', borderRadius: '12px' }} />
                )}
                <div style={{ fontSize: '0.85rem', color: getClassColor(currentMed.category), marginBottom: '1rem', textAlign: 'center', textTransform: 'uppercase', letterSpacing: '0.1em', fontWeight: 700 }}>
                  Nom Commercial
                </div>
                <div style={{ fontSize: '1.8rem', fontWeight: 700, color: '#1e293b', marginBottom: '1rem', textAlign: 'center' }}>
                  {currentMed.commercial.join(' ‚Ä¢ ')}
                </div>
                <div style={{ display: 'flex', justifyContent: 'center' }}>
                  <div style={{ display: 'inline-block', padding: '0.5rem 1.5rem', background: `${getClassColor(currentMed.category)}20`, borderRadius: '20px', color: getClassColor(currentMed.category), fontSize: '0.85rem', fontWeight: 600 }}>
                    {currentMed.category}
                  </div>
                </div>
              </div>

              {!showQuizFeedback ? (
                <form onSubmit={handleQuizSubmit}>
                  <input 
                    type="text" 
                    value={userAnswer} 
                    onChange={(e) => setUserAnswer(e.target.value)} 
                    placeholder="Entrez le DCI..." 
                    autoFocus 
                    style={{ width: '100%', padding: '1rem', border: '2px solid #e2e8f0', borderRadius: '12px', fontSize: '1rem', marginBottom: '1rem' }} 
                  />
                  <button type="submit" className="button-hover" style={{ width: '100%', padding: '1rem', background: '#334155', border: 'none', borderRadius: '12px', color: 'white', cursor: 'pointer', fontWeight: 600, fontSize: '1rem' }}>
                    Valider
                  </button>
                </form>
              ) : (
                <div>
                  <div style={{ padding: '1.5rem', background: checkAnswer(userAnswer, currentMed.dci) ? '#D1FAE5' : '#FEE2E2', borderRadius: '12px', marginBottom: '1rem', border: `2px solid ${checkAnswer(userAnswer, currentMed.dci) ? '#10B981' : '#EF4444'}` }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.75rem' }}>
                      {checkAnswer(userAnswer, currentMed.dci) ? (
                        <>
                          <Check size={24} style={{ color: '#059669' }} />
                          <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#059669' }}>Correct !</span>
                        </>
                      ) : (
                        <>
                          <X size={24} style={{ color: '#DC2626' }} />
                          <span style={{ fontSize: '1.1rem', fontWeight: 700, color: '#DC2626' }}>Incorrect</span>
                        </>
                      )}
                    </div>
                    <div style={{ fontSize: '0.9rem', color: '#1e293b' }}>
                      <div>Votre r√©ponse : <strong>{userAnswer || '(vide)'}</strong></div>
                      <div>Bonne r√©ponse : <strong>{currentMed.dci}</strong></div>
                    </div>
                  </div>
                  <button onClick={handleNext} className="button-hover" style={{ width: '100%', padding: '1rem', background: '#334155', border: 'none', borderRadius: '12px', color: 'white', cursor: 'pointer', fontWeight: 600, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.5rem' }}>
                    <span>Suivant</span>
                    <ChevronRight size={20} />
                  </button>
                </div>
              )}
            </div>
          )}

          
          {/* MODAL GESTION DES DONN√âES */}
          {showDataManagement && (
            <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'rgba(0,0,0,0.6)', zIndex: 2000, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '1rem' }} onClick={() => setShowDataManagement(false)}>
              <div onClick={(e) => e.stopPropagation()} style={{ background: 'white', borderRadius: '20px', padding: '2rem', maxWidth: '500px', width: '100%' }}>
                <h2 style={{ fontSize: '1.5rem', marginBottom: '1.5rem', color: '#1e293b', display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                  <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#3B82F6" strokeWidth="2">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                    <polyline points="17 21 17 13 7 13 7 21"/>
                    <polyline points="7 3 7 8 15 8"/>
                  </svg>
                  Gestion des donn√©es
                </h2>
                
                <div style={{ marginBottom: '1.5rem', padding: '1rem', background: '#F0F9FF', borderRadius: '12px', border: '2px solid #3B82F6' }}>
                  <div style={{ fontSize: '0.9rem', color: '#1e293b', lineHeight: '1.6' }}>
                    <strong>üíæ Sauvegarde locale automatique</strong>
                    <div style={{ marginTop: '0.5rem', fontSize: '0.85rem', color: '#64748b' }}>
                      Vos donn√©es sont sauvegard√©es automatiquement dans votre navigateur. Utilisez les boutons ci-dessous pour exporter, importer ou r√©initialiser.
                    </div>
                  </div>
                </div>

                <div style={{ display: 'grid', gap: '0.75rem', marginBottom: '1.5rem' }}>
                  <button onClick={() => { exportData(); setShowDataManagement(false); }} className="button-hover" style={{ padding: '1rem', background: '#10B981', border: 'none', borderRadius: '12px', color: 'white', cursor: 'pointer', fontWeight: 600, fontSize: '1rem', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.75rem' }}>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                      <polyline points="7 10 12 15 17 10"/>
                      <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    Exporter mes donn√©es
                  </button>
                  
                  <label style={{ padding: '1rem', background: '#3B82F6', border: 'none', borderRadius: '12px', color: 'white', cursor: 'pointer', fontWeight: 600, fontSize: '1rem', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.75rem', transition: 'all 0.3s' }} className="button-hover">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                      <polyline points="17 8 12 3 7 8"/>
                      <line x1="12" y1="3" x2="12" y2="15"/>
                    </svg>
                    Importer des donn√©es
                    <input type="file" accept=".json" onChange={(e) => { importData(e); setShowDataManagement(false); }} style={{ display: 'none' }} />
                  </label>
                  
                  <button onClick={() => { resetToDefault(); setShowDataManagement(false); }} className="button-hover" style={{ padding: '1rem', background: '#EF4444', border: 'none', borderRadius: '12px', color: 'white', cursor: 'pointer', fontWeight: 600, fontSize: '1rem', display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '0.75rem' }}>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                      <polyline points="1 4 1 10 7 10"/>
                      <polyline points="23 20 23 14 17 14"/>
                      <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
                    </svg>
                    R√©initialiser tout
                  </button>
                </div>

                <div style={{ padding: '1rem', background: '#FEF3C7', borderRadius: '10px', fontSize: '0.85rem', color: '#92400E', lineHeight: '1.5', marginBottom: '1.5rem' }}>
                  <strong>üí° Conseil :</strong> Exportez r√©guli√®rement vos donn√©es pour √©viter toute perte. Le fichier JSON peut √™tre partag√© avec vos coll√®gues pour qu'ils aient la m√™me liste de m√©dicaments.
                </div>

                <button onClick={() => setShowDataManagement(false)} className="button-hover" style={{ width: '100%', padding: '1rem', background: '#e2e8f0', border: 'none', borderRadius: '12px', color: '#1e293b', cursor: 'pointer', fontWeight: 600, fontSize: '1rem' }}>
                  Fermer
                </button>
              </div>
            </div>
          )}

          {/* MODAL SETTINGS */}
          {showSettings && (
            <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'rgba(0,0,0,0.5)', zIndex: 1000, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '1rem' }} onClick={() => { setShowSettings(false); setSelectionMode('all'); }}>
              <div onClick={(e) => e.stopPropagation()} style={{ background: 'white', borderRadius: '20px', padding: '2rem', maxWidth: '600px', width: '100%', maxHeight: '90vh', overflowY: 'auto' }}>
                <h2 style={{ fontSize: '1.5rem', marginBottom: '1.5rem', color: '#1e293b' }}>
                  {mode === 'quiz' ? 'Configuration du Quiz' : 'S√©lection'}
                </h2>
                
                <div style={{ marginBottom: '1.5rem' }}>
                  {mode === 'quiz' && (
                    <div style={{ marginBottom: '1.5rem', padding: '1rem', background: '#F0F9FF', borderRadius: '12px', border: '2px solid #3B82F6' }}>
                      <label style={{ display: 'block', marginBottom: '0.75rem', fontWeight: 600, color: '#1e293b' }}>
                        Nombre de questions : {quizCardCount}
                      </label>
                      <input 
                        type="range" 
                        min="5" 
                        max={medications.length} 
                        value={quizCardCount} 
                        onChange={(e) => setQuizCardCount(Number(e.target.value))}
                        style={{ width: '100%', height: '8px', borderRadius: '4px', background: '#e2e8f0', outline: 'none', cursor: 'pointer' }}
                      />
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '0.5rem', fontSize: '0.85rem', color: '#64748b' }}>
                        <span>5</span>
                        <span>{medications.length} (tous)</span>
                      </div>
                    </div>
                  )}
                  
                  <div style={{ marginBottom: '1rem' }}>
                    <label style={{ display: 'flex', alignItems: 'center', padding: '1rem', background: selectionMode === 'all' ? '#EFF6FF' : 'white', border: `2px solid ${selectionMode === 'all' ? '#3B82F6' : '#e2e8f0'}`, borderRadius: '12px', cursor: 'pointer', marginBottom: '0.5rem' }}>
                      <input type="radio" name="mode" value="all" checked={selectionMode === 'all'} onChange={(e) => setSelectionMode(e.target.value)} style={{ marginRight: '0.75rem' }} />
                      <span style={{ fontWeight: 600, color: '#1e293b' }}>
                        {mode === 'quiz' ? `${quizCardCount} questions al√©atoires` : 'Tous les m√©dicaments'} ({medications.length})
                      </span>
                    </label>
                    
                    <label style={{ display: 'flex', alignItems: 'center', padding: '1rem', background: selectionMode === 'class' ? '#EFF6FF' : 'white', border: `2px solid ${selectionMode === 'class' ? '#3B82F6' : '#e2e8f0'}`, borderRadius: '12px', cursor: 'pointer', marginBottom: '0.5rem' }}>
                      <input type="radio" name="mode" value="class" checked={selectionMode === 'class'} onChange={(e) => setSelectionMode(e.target.value)} style={{ marginRight: '0.75rem' }} />
                      <span style={{ fontWeight: 600, color: '#1e293b' }}>S√©lection par classe</span>
                    </label>
                    
                    {mode === 'quiz' && (
                      <label style={{ display: 'flex', alignItems: 'center', padding: '1rem', background: selectionMode === 'custom' ? '#EFF6FF' : 'white', border: `2px solid ${selectionMode === 'custom' ? '#3B82F6' : '#e2e8f0'}`, borderRadius: '12px', cursor: 'pointer' }}>
                        <input type="radio" name="mode" value="custom" checked={selectionMode === 'custom'} onChange={(e) => setSelectionMode(e.target.value)} style={{ marginRight: '0.75rem' }} />
                        <span style={{ fontWeight: 600, color: '#1e293b' }}>S√©lection personnalis√©e</span>
                      </label>
                    )}
                  </div>

                  {selectionMode === 'class' && (
                    <div style={{ padding: '1rem', background: '#f8fafc', borderRadius: '12px', border: '2px solid #e2e8f0' }}>
                      <div style={{ fontSize: '0.85rem', color: '#64748b', marginBottom: '0.75rem', fontWeight: 600 }}>Classes th√©rapeutiques :</div>
                      <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                        {getCategories().map(cat => {
                          const count = medications.filter(m => m.category === cat).length;
                          const isSelected = selectedClasses.includes(cat);
                          return (
                            <button 
                              key={cat}
                              onClick={() => setSelectedClasses(
                                isSelected 
                                  ? selectedClasses.filter(c => c !== cat) 
                                  : [...selectedClasses, cat]
                              )}
                              style={{ 
                                padding: '0.5rem 1rem', 
                                background: isSelected ? getClassColor(cat) : 'white', 
                                border: `2px solid ${getClassColor(cat)}`, 
                                borderRadius: '8px', 
                                color: isSelected ? 'white' : getClassColor(cat), 
                                cursor: 'pointer', 
                                fontWeight: 600, 
                                fontSize: '0.85rem',
                                transition: 'all 0.2s'
                              }}
                            >
                              {cat} ({count})
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  )}
                  
                  {selectionMode === 'custom' && mode === 'quiz' && (
                    <div style={{ padding: '1rem', background: '#f8fafc', borderRadius: '12px', border: '2px solid #e2e8f0', maxHeight: '300px', overflowY: 'auto' }}>
                      <div style={{ fontSize: '0.85rem', color: '#64748b', marginBottom: '0.75rem', fontWeight: 600 }}>
                        S√©lectionnez les m√©dicaments ({selectedMeds.length} s√©lectionn√©{selectedMeds.length > 1 ? 's' : ''}) :
                      </div>
                      {medications.map((med, idx) => {
                        const isSelected = selectedMeds.includes(idx);
                        return (
                          <label 
                            key={idx} 
                            style={{ 
                              display: 'flex', 
                              alignItems: 'center', 
                              padding: '0.75rem', 
                              background: isSelected ? `${getClassColor(med.category)}20` : 'white', 
                              border: `2px solid ${isSelected ? getClassColor(med.category) : '#e2e8f0'}`,
                              borderRadius: '8px', 
                              marginBottom: '0.5rem', 
                              cursor: 'pointer',
                              transition: 'all 0.2s'
                            }}
                          >
                            <input 
                              type="checkbox" 
                              checked={isSelected}
                              onChange={() => setSelectedMeds(
                                isSelected 
                                  ? selectedMeds.filter(i => i !== idx)
                                  : [...selectedMeds, idx]
                              )}
                              style={{ marginRight: '0.75rem', width: '18px', height: '18px', cursor: 'pointer' }}
                            />
                            <div style={{ flex: 1 }}>
                              <div style={{ fontWeight: 600, color: '#1e293b', fontSize: '0.9rem' }}>{med.commercial.join(' ‚Ä¢ ')}</div>
                              <div style={{ fontSize: '0.8rem', color: '#64748b' }}>{med.dci}</div>
                            </div>
                            
                          </label>
                        );
                      })}
                    </div>
                  )}
                </div>

                <div style={{ display: 'flex', gap: '1rem' }}>
                  <button onClick={() => { setShowSettings(false); setSelectionMode('all'); }} className="button-hover" style={{ flex: 1, padding: '1rem', background: '#e2e8f0', border: 'none', borderRadius: '12px', color: '#1e293b', cursor: 'pointer', fontWeight: 600 }}>
                    Annuler
                  </button>
                  <button onClick={applySelection} className="button-hover" style={{ flex: 1, padding: '1rem', background: '#334155', border: 'none', borderRadius: '12px', color: 'white', cursor: 'pointer', fontWeight: 600 }}>
                    {mode === 'quiz' ? 'D√©marrer le Quiz' : 'Appliquer'}
                  </button>
                </div>
              </div>
            </div>
          )}

          {/* MODAL GESTION */}
          {showManagement && (
            <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'rgba(0,0,0,0.5)', zIndex: 1000, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '1rem' }} onClick={() => { setShowManagement(false); cancelEdit(); setErrorMessage(''); setShowClassManager(false); setEditingClass(null); }}>
              <div onClick={(e) => e.stopPropagation()} style={{ background: 'white', borderRadius: '20px', padding: '2rem', maxWidth: '700px', width: '100%', maxHeight: '90vh', overflowY: 'auto' }}>
                <h2 style={{ fontSize: '1.5rem', marginBottom: '1.5rem', color: '#1e293b' }}>Gestion des cartes</h2>

                {errorMessage && (
                  <div style={{ padding: '1rem', background: '#FEE2E2', border: '2px solid #DC2626', borderRadius: '8px', color: '#991B1B', marginBottom: '1rem', fontSize: '0.9rem' }}>
                    {errorMessage}
                  </div>
                )}

                <div style={{ padding: '1.5rem', background: editingIndex !== null ? '#FEF3C7' : '#f8fafc', borderRadius: '12px', marginBottom: '1.5rem', border: editingIndex !== null ? '2px solid #F59E0B' : 'none' }}>
                  <h3 style={{ fontSize: '1rem', marginBottom: '1rem', color: '#1e293b' }}>
                    {editingIndex !== null ? '‚úèÔ∏è Modifier' : '‚ûï Ajouter'}
                  </h3>
                  
                  <input type="text" placeholder="DCI *" value={customMed.dci} onChange={(e) => setCustomMed({...customMed, dci: e.target.value})} style={{ width: '100%', padding: '0.75rem', border: '2px solid #e2e8f0', borderRadius: '8px', marginBottom: '0.75rem', fontSize: '0.9rem' }} />
                  
                  <input type="text" placeholder="Nom(s) commercial(aux) s√©par√©s par des virgules *" value={customMed.commercial} onChange={(e) => setCustomMed({...customMed, commercial: e.target.value})} style={{ width: '100%', padding: '0.75rem', border: '2px solid #e2e8f0', borderRadius: '8px', marginBottom: '0.75rem', fontSize: '0.9rem' }} />
                  
                  <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.75rem' }}>
                    <select value={customMed.category} onChange={(e) => setCustomMed({...customMed, category: e.target.value})} style={{ flex: 1, padding: '0.75rem', border: '2px solid #e2e8f0', borderRadius: '8px', fontSize: '0.9rem', cursor: 'pointer' }}>
                      <option value="">-- S√©lectionner --</option>
                      {getCategories().map(cat => (
                        <option key={cat} value={cat}>{cat}</option>
                      ))}
                    </select>
                    <button onClick={() => setShowClassManager(!showClassManager)} className="button-hover" style={{ padding: '0.75rem', background: showClassManager ? '#3B82F6' : '#e2e8f0', border: 'none', borderRadius: '8px', color: showClassManager ? 'white' : '#64748b', cursor: 'pointer', fontWeight: 600, fontSize: '0.85rem' }}>
                      Modifier
                    </button>
                  </div>
                  
                  {showClassManager && (
                    <div style={{ padding: '1rem', background: 'white', borderRadius: '8px', marginBottom: '0.75rem', border: '2px solid #3B82F6' }}>
                      <div style={{ fontSize: '0.85rem', fontWeight: 600, marginBottom: '0.5rem', color: '#1e293b' }}>Ajouter une nouvelle classe</div>
                      <input type="text" placeholder="Nom de la classe" value={newClassName} onChange={(e) => setNewClassName(e.target.value)} style={{ width: '100%', padding: '0.5rem', border: '2px solid #e2e8f0', borderRadius: '6px', marginBottom: '0.5rem', fontSize: '0.85rem' }} />
                      <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', marginBottom: '0.5rem' }}>
                        <input type="color" value={newClassColor} onChange={(e) => setNewClassColor(e.target.value)} style={{ width: '40px', height: '40px', border: 'none', borderRadius: '6px', cursor: 'pointer' }} />
                        <div style={{ flex: 1, padding: '0.5rem', background: newClassColor, borderRadius: '6px', color: 'white', textAlign: 'center', fontWeight: 600, fontSize: '0.85rem' }}>
                          Aper√ßu
                        </div>
                      </div>
                      <button onClick={addNewClass} className="button-hover" style={{ width: '100%', padding: '0.5rem', background: '#10B981', border: 'none', borderRadius: '6px', color: 'white', cursor: 'pointer', fontWeight: 600, fontSize: '0.85rem' }}>
                        Ajouter
                      </button>
                      
                      <div style={{ marginTop: '1rem', paddingTop: '1rem', borderTop: '1px solid #e2e8f0' }}>
                        <div style={{ fontSize: '0.85rem', fontWeight: 600, marginBottom: '0.5rem', color: '#1e293b' }}>G√©rer les classes existantes</div>
                        {Object.entries(therapeuticClasses).map(([className, color]) => {
                          const isEditing = editingClass === className;
                          const medsInClass = medications.filter(m => m.category === className).length;
                          return (
                            <div key={className} style={{ padding: '0.5rem', background: isEditing ? '#FEF3C7' : '#f8fafc', borderRadius: '6px', marginBottom: '0.5rem', border: isEditing ? '2px solid #F59E0B' : '1px solid #e2e8f0' }}>
                              {isEditing ? (
                                <div>
                                  <input type="text" defaultValue={className} id={`edit-${className}`} style={{ width: '100%', padding: '0.4rem', border: '1px solid #e2e8f0', borderRadius: '4px', marginBottom: '0.3rem', fontSize: '0.8rem' }} />
                                  <div style={{ display: 'flex', gap: '0.3rem', marginBottom: '0.3rem' }}>
                                    <input type="color" defaultValue={color} id={`color-${className}`} style={{ width: '30px', height: '30px', border: 'none', borderRadius: '4px' }} />
                                    <div style={{ flex: 1, padding: '0.3rem', background: color, borderRadius: '4px', color: 'white', textAlign: 'center', fontSize: '0.75rem', fontWeight: '600' }}>
                                      Aper√ßu
                                    </div>
                                  </div>
                                  <div style={{ display: 'flex', gap: '0.3rem' }}>
                                    <button onClick={() => { const newName = document.getElementById(`edit-${className}`).value; const newColor = document.getElementById(`color-${className}`).value; updateClass(className, newName, newColor); }} className="button-hover" style={{ flex: 1, padding: '0.4rem', background: '#10B981', border: 'none', borderRadius: '4px', color: 'white', cursor: 'pointer', fontSize: '0.75rem', fontWeight: 600 }}>
                                      Valider
                                    </button>
                                    <button onClick={() => setEditingClass(null)} className="button-hover" style={{ flex: 1, padding: '0.4rem', background: '#e2e8f0', border: 'none', borderRadius: '4px', color: '#64748b', cursor: 'pointer', fontSize: '0.75rem', fontWeight: 600 }}>
                                      Annuler
                                    </button>
                                  </div>
                                </div>
                              ) : (
                                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                  <div style={{ width: '20px', height: '20px', background: color, borderRadius: '4px' }} />
                                  <span style={{ flex: 1, fontSize: '0.85rem', fontWeight: 600, color: '#1e293b' }}>{className} ({medsInClass})</span>
                                  <button onClick={() => setEditingClass(className)} className="button-hover" style={{ padding: '0.3rem', background: '#DBEAFE', border: 'none', borderRadius: '4px', cursor: 'pointer' }}>
                                    <Edit size={12} color="#1E40AF" />
                                  </button>
                                  <button type="button" onClick={() => {
                                    console.log('className:', className);
                                    const medsCount = medications.filter(m => m.category === className).length;
                                    console.log('Nombre de m√©dicaments avec cette classe:', medsCount);
                                    if (medsCount > 0) {
                                      const updatedMeds = medications.map(med => 
                                        med.category === className ? {...med, category: 'Non attribu√©e'} : med
                                      );
                                      setMedications(updatedMeds);
                                      if (!therapeuticClasses['Non attribu√©e']) {
                                        setTherapeuticClasses({...therapeuticClasses, 'Non attribu√©e': '#9CA3AF'});
                                      }
                                    }
                                    console.log('Suppression directe');
                                    const updated = {...therapeuticClasses};
                                    delete updated[className];
                                    console.log('Nouveau dictionnaire de classes:', updated);
                                    setTherapeuticClasses(updated);
                                    console.log('Suppression classe termin√©e');
                                  }} className="button-hover" style={{ padding: '0.3rem', background: '#FEE2E2', border: 'none', borderRadius: '4px', cursor: 'pointer' }}>
                                    <Trash2 size={12} color="#DC2626" />
                                  </button>
                                </div>
                              )}
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  )}
                  
                  <div style={{ marginBottom: '0.75rem' }}>
                    <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.85rem', color: '#64748b', fontWeight: 600 }}>
                      Image (optionnel) {customMed.image && '‚úì'}
                    </label>
                    <input type="file" accept="image/*" onChange={handleImageUpload} style={{ width: '100%', padding: '0.5rem', border: '2px solid #e2e8f0', borderRadius: '8px', fontSize: '0.85rem' }} />
                  </div>
                  
                  <div style={{ display: 'flex', gap: '0.5rem' }}>
                    {editingIndex !== null && (
                      <button onClick={cancelEdit} className="button-hover" style={{ flex: 1, padding: '0.75rem', background: '#e2e8f0', border: 'none', borderRadius: '8px', color: '#64748b', cursor: 'pointer', fontWeight: 600, fontSize: '0.9rem' }}>
                        Annuler
                      </button>
                    )}
                    <button onClick={saveMedication} className="button-hover" style={{ flex: 1, padding: '0.75rem', background: '#10B981', border: 'none', borderRadius: '8px', color: 'white', cursor: 'pointer', fontWeight: 600, fontSize: '0.9rem' }}>
                      {editingIndex !== null ? 'Modifier' : 'Ajouter'}
                    </button>
                  </div>
                </div>

                <div style={{ marginBottom: '1rem' }}>
                  <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '0.75rem' }}>
                    <select value={sortBy} onChange={(e) => setSortBy(e.target.value)} style={{ flex: 1, padding: '0.5rem', border: '2px solid #e2e8f0', borderRadius: '8px', fontSize: '0.85rem', cursor: 'pointer' }}>
                      <option value="dci">Trier par: DCI</option>
                      <option value="commercial">Trier par: Nom commercial</option>
                      <option value="category">Trier par: Classe</option>
                    </select>
                    <select value={filterCategory} onChange={(e) => setFilterCategory(e.target.value)} style={{ flex: 1, padding: '0.5rem', border: '2px solid #e2e8f0', borderRadius: '8px', fontSize: '0.85rem', cursor: 'pointer' }}>
                      <option value="all">Toutes les classes</option>
                      {getCategories().map(cat => (
                        <option key={cat} value={cat}>{cat}</option>
                      ))}
                    </select>
                  </div>
                </div>

                <div style={{ maxHeight: '300px', overflowY: 'auto', marginBottom: '1rem' }}>
                  {getSortedMedications().map((med, i) => {
                    const originalIndex = medications.indexOf(med);
                    const isEditing = editingIndex === originalIndex;
                    return (
                      <div key={i} style={{ padding: '1rem', background: isEditing ? '#FEF3C7' : 'white', border: `2px solid ${getClassColor(med.category)}`, borderRadius: '8px', marginBottom: '0.5rem', display: 'flex', gap: '1rem', alignItems: 'center' }}>
                        {med.image ? (
                          <div style={{ position: 'relative' }}>
                            <img src={med.image} alt={med.dci} style={{ width: '50px', height: '50px', objectFit: 'cover', borderRadius: '8px', border: `2px solid ${getClassColor(med.category)}` }} />
                            <div style={{ position: 'absolute', bottom: -4, right: -4, width: '20px', height: '20px', background: '#10B981', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                              <Camera size={12} color="white" />
                            </div>
                          </div>
                        ) : (
                          <div style={{ width: '50px', height: '50px', background: '#f1f5f9', borderRadius: '8px', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#cbd5e1' }}>
                            <ImagePlaceholder />
                          </div>
                        )}
                        <div style={{ flex: 1 }}>
                          <div style={{ fontSize: '0.9rem', fontWeight: 700, color: '#1e293b' }}>{med.commercial.join(' ‚Ä¢ ')}</div>
                          <div style={{ fontSize: '0.8rem', color: '#64748b' }}>{med.dci}</div>
                          
                        </div>
                        <div style={{ display: 'flex', gap: '0.5rem' }}>
                          <button type="button" onClick={() => startEditMedication(originalIndex)} className="button-hover" style={{ padding: '0.5rem', background: isEditing ? '#F59E0B' : '#DBEAFE', border: 'none', borderRadius: '6px', color: isEditing ? 'white' : '#1E40AF', cursor: 'pointer' }}>
                            <Edit size={16} />
                          </button>
                          <button type="button" onClick={() => {
                            console.log('originalIndex:', originalIndex);
                            console.log('med:', med);
                            console.log('medications actuel:', medications);
                            console.log('medications.length:', medications.length);
                            console.log('Suppression directe (sans confirmation)');
                            const newMeds = medications.filter((_, idx) => idx !== originalIndex);
                            console.log('Nouveau tableau:', newMeds);
                            console.log('Nouvelle longueur:', newMeds.length);
                            setMedications(newMeds);
                            if (editingIndex === originalIndex) cancelEdit();
                            console.log('Suppression termin√©e');
                          }} className="button-hover" style={{ padding: '0.5rem', background: '#FEE2E2', border: 'none', borderRadius: '6px', color: '#DC2626', cursor: 'pointer' }}>
                            <Trash2 size={16} />
                          </button>
                        </div>
                      </div>
                    );
                  })}
                </div>

                <button onClick={() => { setShowManagement(false); cancelEdit(); setErrorMessage(''); setShowClassManager(false); setEditingClass(null); }} className="button-hover" style={{ width: '100%', marginTop: '1rem', padding: '1rem', background: '#e2e8f0', border: 'none', borderRadius: '12px', color: '#1e293b', cursor: 'pointer', fontWeight: 600 }}>
                  Fermer
                </button>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
}


    ReactDOM.createRoot(document.getElementById('root')).render(<PharmaQuizz />);
  </script>
</body>
</html>